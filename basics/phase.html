
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Phase &#8212; Open-Source Tools &amp; Data for Music Source Separation</title>
    
  <link rel="stylesheet" href="../_static/css/index.d431a4ee1c1efae0e38bdfebc22debff.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.bfb7730f9caf2ec0b46a44615585038c.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.30270b6e4c972e43c488.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Evaluation" href="eval.html" />
    <link rel="prev" title="TF Representations and Masking" href="tf_and_masking.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">Open-Source Tools & Data for Music Source Separation</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../landing.html">
   Welcome!
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/tutorial_structure.html">
   Tutorial Structure and Setup
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/src_sep_101.html">
   What is Source Separation?
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Basics of Source Separation
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="representations.html">
   Representing Audio
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nussl_intro.html">
   Introduction to nussl
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tf_and_masking.html">
   TF Representations and Masking
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Phase
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="eval.html">
   Evaluation
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Classic Approaches
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../approaches/classic/intro.html">
   Introduction to Classic Approaches
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../approaches/classic/repetition.html">
   Repetition and Median Filtering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../approaches/classic/nmf.html">
   Non-Negative Matrix Factorization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../approaches/classic/spatial.html">
   Spatial Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../approaches/classic/melodia.html">
   Melodia
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Deep Learning Approaches
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../approaches/deep/intro.html">
   Introduction to Deep Learning-based Approaches
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../approaches/deep/masking.html">
   Deep Learning - Masking-based Approaches
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../approaches/deep/waveform.html">
   Deep Learning - Waveform-based Approaches
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../approaches/open_src_projects.html">
   Guide to Open-Source Source Separation Projects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../approaches/open_src_projects.html#architecture-specific-repositories">
   Architecture-Specific Repositories
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Data
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../data/introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data/datasets.html">
   Datasets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data/musdb18.html">
   The MUSDB18 dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data/scaper.html">
   Generating mixtures with Scaper
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Conclusions
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../conclusions/applications.html">
   Applications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../conclusions/concluding_remarks.html">
   Concluding Remarks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../conclusions/additional_resources.html">
   Additional Resources
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../zzz_refs.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/resources.html">
   Additional Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/acknowledgements.html">
   Acknowledgements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/authors.html">
   About the Authors
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/basics/phase.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/source-separation/tutorial"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/source-separation/tutorial/issues/new?title=Issue%20on%20page%20%2Fbasics/phase.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#phase-a-quick-primer">
   Phase - A Quick Primer
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-we-don-t-model-phase">
   Why We Don’t Model Phase
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-deal-with-phase">
   How to Deal with Phase
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-easy-way">
     The Easy Way
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-hard-way-part-1-phase-estimation">
     The Hard Way, Part 1: Phase Estimation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-hard-way-part-2-waveform-estimation">
     The Hard Way, Part 2:  Waveform Estimation
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="phase">
<h1>Phase<a class="headerlink" href="#phase" title="Permalink to this headline">¶</a></h1>
<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/FTQbiNvZqaY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</p>
<details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
Video not working?<div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<p class="card-text">Here is a <a href="">OneDrive link</a> to the full video.
<a href=""></a></p>
</div>
</details><p>While many source separation papers mainly focus on their approaches for creating
better mask estimates, which only apply to the magnitude components of a
<a class="reference internal" href="../appendix/glossary.html#term-TF-Representation"><span class="xref std std-term">TF Representation</span></a>, the other crucial aspect of sound is its phase.</p>
<p>In this section, we will discuss the important problem of how to turn a magnitude
spectrogram of an estimated source back into a waveform so that we may listen to
the source estimation.</p>
<div class="section" id="phase-a-quick-primer">
<h2>Phase - A Quick Primer<a class="headerlink" href="#phase-a-quick-primer" title="Permalink to this headline">¶</a></h2>
<p>[[PHASE IMAGE]]</p>
<p>An audio signal, <span class="math notranslate nohighlight">\(y(t)\)</span>, composed of exactly one sine wave,</p>
<div class="math notranslate nohighlight">
\[
y(t) = A \sin (2 \pi f t + \phi)
\]</div>
<p>can be completely described by the parameters <span class="math notranslate nohighlight">\(t, A, f\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span>, where
<span class="math notranslate nohighlight">\(t\)</span> represents time in seconds, <span class="math notranslate nohighlight">\(A\)</span> is the wave’s amplitude (unit-less), <span class="math notranslate nohighlight">\(f\)</span> is
its frequency in Hz, and <span class="math notranslate nohighlight">\(\phi\)</span> is its phase offset in radians (<em>i.e.,</em> where
in the cycle the wave is at <span class="math notranslate nohighlight">\(t=0\)</span>). If <span class="math notranslate nohighlight">\(\phi \ne 0\)</span>, then the sine wave appears
shifted in time by <span class="math notranslate nohighlight">\(\frac{\phi}{2 \pi f}\)</span>, where negative values “delay” the
signal and positive values “advance” it. Recall that a sine wave is the same
value every <span class="math notranslate nohighlight">\(2 \pi f\)</span> seconds,
<em>i.e.</em></p>
<div class="math notranslate nohighlight">
\[
\sin (0) = \sin(2 \pi f) = \sin(2k \pi f) ~ \forall ~ k \in \mathbb{Z}.
\]</div>
<p>This is inherent the periodicity of the sine wave, and the point where the phase
“wraps around” or essentially restarts at 0 every <span class="math notranslate nohighlight">\(2 \pi f\)</span> seconds.</p>
<p>Let’s scale this up. Our old pal Fourier told us that
<a class="reference external" href="https://en.wikipedia.org/wiki/Fourier_transform">any sound can be represented as an infinite summation of sine waves</a>
each with their own amplitudes, frequencies, and phase offsets. This means that any sound
we hear can be represented as many, many tuples of <span class="math notranslate nohighlight">\((t, A, f, \phi)\)</span>.</p>
<p>Let’s think back
to the section about time-frequency representations: each bin is index by time
along the x-axis and frequency along the y-axis.
We’ll be a little hand-wavy here, but we can think of a <a class="reference internal" href="../appendix/glossary.html#term-TF-bin"><span class="xref std std-term">TF bin</span></a> as a “snapshot”
of the sound at that particular time and at that particular frequency component.
In a magnitude spectrogram, power spectrogram, log spectrogram, etc, each value
represents the sound’s energy for that frequency at that time. So, if you’re keeping
track at home, a spectrogram has entries for <span class="math notranslate nohighlight">\(t, A\)</span> and <span class="math notranslate nohighlight">\(f\)</span>, but <em>no representation
for the phase <span class="math notranslate nohighlight">\(\phi\)</span>.</em></p>
<p>Phase is crucial to be able to describe and audio signal. Why don’t most source separation
approaches model phase information?</p>
</div>
<div class="section" id="why-we-don-t-model-phase">
<h2>Why We Don’t Model Phase<a class="headerlink" href="#why-we-don-t-model-phase" title="Permalink to this headline">¶</a></h2>
<p>[[REAL PHASE &amp; GAUSSIAN NOISE]]</p>
<p>Let’s do a little experiment. Above are two images. One of the two images shows
the phase component of an audio signal, the other shows gaussian noise. Can you
guess which is which?</p>
<p>Therein lies the problem: there is a complicated interplay between how the
<a class="reference internal" href="../appendix/glossary.html#term-DFT"><span class="xref std std-term">DFT</span></a> captures the signal at each time step, how the frequency is captured
and how the phase is captured. Let’s build some intuition for why this is.
For the same time step, the lower frequency components of the signal change less
quickly than the higher frequency components. This means that for any two adjacent
time steps, the time difference is the same but the amount of change of any frequency
might not be the same. The phase wraparound happens much quicker at the higher frequencies
than at the lower frequencies.</p>
<p>For instance, let’s say we have a sound wave that is composed
of two sine waves that have frequency <span class="math notranslate nohighlight">\(440\)</span> Hz and <span class="math notranslate nohighlight">\(523.25\)</span> Hz, which are A440 and
the C note above A440 respectively. Both start at the origin at time <span class="math notranslate nohighlight">\(t = 0\)</span>.
Let’s look at the value of each of these sine waves at different time intervals:</p>
<p>When we take snapshots of each sine wave, it’s difficult to find a pattern between
the two (other than, y’know, the sine wave we drew them from).
Another difficulty is that humans do not always perceive phase offsets,, <em>i.e.</em>,
a sine wave with <span class="math notranslate nohighlight">\(\phi = 0\)</span> sounds the same as a sine wave with <span class="math notranslate nohighlight">\(\phi` \ne 0\)</span></p>
<p>This is all to say that getting phase right is <em>hard</em>. That being said, there are ways
to estimate phase, but few if any source separation approaches
(or sound generation models) attempt to explicitly model phase to the same extent
that magnitude information is modeled. We will discuss some of these phase estimation
techniques below.</p>
</div>
<div class="section" id="how-to-deal-with-phase">
<h2>How to Deal with Phase<a class="headerlink" href="#how-to-deal-with-phase" title="Permalink to this headline">¶</a></h2>
<p>In this section, we will touch on some approaches to dealing with phase information
in source separation.</p>
<div class="section" id="the-easy-way">
<h3>The Easy Way<a class="headerlink" href="#the-easy-way" title="Permalink to this headline">¶</a></h3>
<p>For a mask-based source separation approach, a easy and very common way to deal with phase
is to just <strong>copy the phase from the mixture!</strong>
The mixture phase is sometimes referred to as the <em>noisy phase</em>.
This strategy isn’t perfect, but researchers have discovered that it works surprisingly well, and
when things go wrong, it’s usually not the fault of the phase.</p>
<p>So now, with this in place, we finally have our first strategy to convert our
source estimate back to a waveform. Assume we have a mixture STFT,
<span class="math notranslate nohighlight">\(Y \in \mathbb{C}^{T \times F}\)</span>, and estimated mask
<span class="math notranslate nohighlight">\(\hat{M}_i \in [0.0, 1.0]^{T \times F}\)</span> for Source <span class="math notranslate nohighlight">\(i\)</span>.
Recall that we can apply the mask to a magnitude spectrogram of <span class="math notranslate nohighlight">\(Y\)</span> like so:</p>
<div class="math notranslate nohighlight">
\[
\hat{X}_i = \hat{M}_i \odot |Y|
\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{X}_i \in \mathbb{R}^{T \times F}\)</span> represents a magnitude spectrogram of
our source estimate. Note that this equation looks similar if we want to apply
a mask to a power spectrogram (<span class="math notranslate nohighlight">\(|Y|^2\)</span>), log spectrogram (<span class="math notranslate nohighlight">\(\log |Y|\)</span>), etc.</p>
<p>Now we can just copy the phase from the mixture over to the magnitude spectrogram
of our source estimate, <span class="math notranslate nohighlight">\(\hat{X_i}\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\tilde{X}_i = \hat{X}_i \odot e^{j \cdot \angle Y}
\]</div>
<p>where we use <span class="math notranslate nohighlight">\(j = \sqrt{-1}\)</span>, “<span class="math notranslate nohighlight">\(\angle\)</span>” to represent the angle of the complex-valued
<a class="reference internal" href="../appendix/glossary.html#term-STFT"><span class="xref std std-term">STFT</span></a> of <span class="math notranslate nohighlight">\(Y\)</span>, and <span class="math notranslate nohighlight">\(\tilde{X}_i \in \mathbb{C}^{T \times F}\)</span> to indicate
that the estimate for Source <span class="math notranslate nohighlight">\(i\)</span> is now complex-valued similar to an <a class="reference internal" href="../appendix/glossary.html#term-STFT"><span class="xref std std-term">STFT</span></a>.</p>
<p>Putting it all together it looks like:</p>
<div class="math notranslate nohighlight">
\[
\tilde{X_i} = (\hat{M}_i \odot |Y|) \odot e^{j \cdot \angle Y}.
\]</div>
<p>This math looks pretty complicated, but this is really just a few lines of code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">apply_mask_with_noisy_phase</span><span class="p">(</span><span class="n">mix_stft</span><span class="p">,</span> <span class="n">mask</span><span class="p">):</span>
    <span class="n">mix_magnitude</span><span class="p">,</span> <span class="n">mix_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">mix_stft</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">mix_stft</span><span class="p">)</span>
    <span class="n">src_magnitude</span> <span class="o">=</span> <span class="n">mix_mag</span> <span class="o">*</span> <span class="n">mask</span>
    <span class="n">src_stft</span> <span class="o">=</span> <span class="n">src_magnitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">mix_phase</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">src_stft</span>
</pre></div>
</div>
</div>
<div class="section" id="the-hard-way-part-1-phase-estimation">
<h3>The Hard Way, Part 1: Phase Estimation<a class="headerlink" href="#the-hard-way-part-1-phase-estimation" title="Permalink to this headline">¶</a></h3>
<p>It is possible to <em>estimate</em> the phase once the estimated mask is applied to the
mixture spectrogram. One popular way is the Griffin-Lim algorithm, which can
iteratively reconstruct the phase component of a spectrogram by…</p>
<p>MISI</p>
<p>It’s worth noting that the STFT &amp; iSTFT computations, and these phase estimation
algorithms are all differentiable and researchers have made models that</p>
</div>
<div class="section" id="the-hard-way-part-2-waveform-estimation">
<h3>The Hard Way, Part 2:  Waveform Estimation<a class="headerlink" href="#the-hard-way-part-2-waveform-estimation" title="Permalink to this headline">¶</a></h3>
<p>Finally, a recent way that researchers have been tackling the phase problem is
by side-stepping any explicit representations of it at all. Recently, many
deep learning-based models have been proposed that are “end-to-end”, meaning that
the model’s input and output are all waveforms. In this case, the model decides
how to represent phase.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "source-separation/tutorial",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./basics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="tf_and_masking.html" title="previous page">TF Representations and Masking</a>
    <a class='right-next' id="next-link" href="eval.html" title="next page">Evaluation</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Ethan Manilow, Prem Seetharaman, Justin Salamon<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.30270b6e4c972e43c488.js"></script>


    
  </body>
</html>